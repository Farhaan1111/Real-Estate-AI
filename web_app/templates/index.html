{% extends "base.html" %}

{% block title %}Home - Real Estate AI{% endblock %}

{% block extra_css %}
<style>
    .hero-pattern {
        background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-primary) 100%);
        position: relative;
        overflow: hidden;
    }
    
    .hero-pattern::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: 
            radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
            radial-gradient(circle at 80% 20%, rgba(139, 92, 246, 0.1) 0%, transparent 50%),
            radial-gradient(circle at 40% 40%, rgba(16, 185, 129, 0.05) 0%, transparent 50%);
        animation: float 6s ease-in-out infinite;
    }
    
    .feature-highlight {
        background: var(--bg-surface);
        border-left: 4px solid var(--primary);
        padding: 2rem;
        border-radius: 0 12px 12px 0;
        margin: 2rem 0;
    }
    
    .tech-stack {
        background: var(--bg-card);
        border-radius: 12px;
        padding: 1.5rem;
        text-align: center;
        transition: all 0.3s ease;
        border: 1px solid var(--border-primary);
    }
    
    .tech-stack:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
    }
    
    .system-status-card {
        background: var(--bg-surface);
        border-radius: 12px;
        padding: 1.5rem;
        border: 1px solid var(--border-primary);
    }
    
    .floating {
        animation: float 3s ease-in-out infinite;
    }
    
    @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-10px); }
    }
    
    .pulse-glow {
        animation: pulse-glow 2s infinite;
    }
    
    @keyframes pulse-glow {
        0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4); }
        70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
        100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
    }
</style>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section hero-pattern">
    <div class="container">
        <div class="row justify-content-center text-center">
            <div class="col-lg-8">
                <div class="floating mb-4">
                    <i class="fas fa-robot fa-4x text-gradient" style="font-size: 4rem;"></i>
                </div>
                <h1 class="hero-title">
                    Real Estate AI Assistant
                </h1>
                <p class="hero-subtitle">
                    Intelligent RERA project insights powered by advanced Hybrid RAG technology.
                    Get precise, real-time information about real estate projects across India.
                </p>
                <div class="action-buttons mt-4">
                    <a href="{{ url_for('chat') }}" class="btn btn-primary-modern btn-lg me-3 pulse-glow">
                        <i class="fas fa-comment-dots me-2"></i>Start AI Chat
                    </a>
                    {% if maps_available %}
                    <a href="{{ url_for('map_view') }}" class="btn btn-outline-modern btn-lg me-3">
                        <i class="fas fa-map-marked-alt me-2"></i>Project Map
                    </a>
                    {% endif %}
                    <a href="{{ url_for('search') }}" class="btn btn-outline-modern btn-lg">
                        <i class="fas fa-search me-2"></i>Advanced Search
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Main Content -->
<div class="container py-5">
    <!-- Stats Section -->
    <div class="row justify-content-center mb-5">
        <div class="col-lg-10">
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-number" id="projectsCount">0</span>
                    <span class="stat-label">RERA Projects</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="buildingsCount">0</span>
                    <span class="stat-label">Buildings</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="locationsCount">0</span>
                    <span class="stat-label">Locations</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">24/7</span>
                    <span class="stat-label">AI Available</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Feature Highlight -->
    <div class="feature-highlight">
        <div class="row align-items-center">
            <div class="col-md-8">
                <h3 class="text-gradient mb-3">Intelligent Project Discovery</h3>
                <p class="text-light mb-0">
                    Our AI-powered platform combines advanced retrieval systems with natural language processing 
                    to provide instant access to comprehensive RERA project data. From building specifications 
                    to legal compliance, get all the information you need in one place.
                </p>
            </div>
            <div class="col-md-4 text-center">
                <div class="feature-icon mx-auto">
                    <i class="fas fa-brain"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Features Section -->
    <div class="row justify-content-center mt-5">
        <div class="col-lg-10">
            <h2 class="text-center text-gradient mb-5">Powerful Features</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <h4>Hybrid RAG</h4>
                    <p class="text-light">Combines semantic and keyword search for precise information retrieval with advanced AI understanding.</p>
                    <ul class="text-muted small mt-2">
                        <li>Semantic Search</li>
                        <li>Keyword Matching</li>
                        <li>Context Understanding</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-database"></i>
                    </div>
                    <h4>Comprehensive Data</h4>
                    <p class="text-light">Access detailed RERA project information including specifications, timelines, and legal status.</p>
                    <ul class="text-muted small mt-2">
                        <li>Project Specifications</li>
                        <li>Timeline Data</li>
                        <li>Legal Compliance</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-map-marked-alt"></i>
                    </div>
                    <h4>Interactive Mapping</h4>
                    <p class="text-light">Visualize RERA projects on interactive maps with location-based insights and geographical analysis.</p>
                    <ul class="text-muted small mt-2">
                        <li>Geographical Visualization</li>
                        <li>Location-based Filtering</li>
                        <li>Area Analysis</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h4>Advanced Analytics</h4>
                    <p class="text-light">Get insights, comparisons, and data-driven analysis of real estate projects and market trends.</p>
                    <ul class="text-muted small mt-2">
                        <li>Project Comparison</li>
                        <li>Market Trends</li>
                        <li>Investment Insights</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Examples -->
    <div class="row justify-content-center mt-5">
        <div class="col-lg-8 text-center">
            <h3 class="text-gradient mb-4">Try These Examples</h3>
            <div class="quick-actions justify-content-center">
                <button class="quick-action example-query" data-query="Show me residential projects in Mumbai">
                    <i class="fas fa-building me-1"></i>Mumbai Projects
                </button>
                <button class="quick-action example-query" data-query="How many floors in UNNATHI WOODS">
                    <i class="fas fa-layer-group me-1"></i>Building Details
                </button>
                <button class="quick-action example-query" data-query="Projects completed in 2024">
                    <i class="fas fa-calendar me-1"></i>Completion Dates
                </button>
                <button class="quick-action example-query" data-query="Compare projects by UNNATHI ESTATES">
                    <i class="fas fa-chart-bar me-1"></i>Project Comparison
                </button>
                {% if maps_available %}
                <a href="{{ url_for('map_view') }}" class="quick-action">
                    <i class="fas fa-map-marked-alt me-1"></i>View Project Map
                </a>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Technology Stack -->
    <div class="row justify-content-center mt-5">
        <div class="col-lg-10">
            <div class="card-dark p-4">
                <h4 class="text-center text-gradient mb-4">Powered by Advanced Technology</h4>
                <div class="row text-center">
                    <div class="col-md-3 mb-4">
                        <div class="tech-stack">
                            <i class="fas fa-vector-square fa-2x text-primary mb-3"></i>
                            <h6 class="text-primary">FAISS Vector DB</h6>
                            <p class="text-muted small mb-0">Efficient similarity search and clustering</p>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="tech-stack">
                            <i class="fas fa-search fa-2x text-success mb-3"></i>
                            <h6 class="text-success">BM25 Retrieval</h6>
                            <p class="text-muted small mb-0">Traditional keyword-based search</p>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="tech-stack">
                            <i class="fas fa-robot fa-2x text-info mb-3"></i>
                            <h6 class="text-info">OpenRouter AI</h6>
                            <p class="text-muted small mb-0">Advanced language models</p>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="tech-stack">
                            <i class="fas fa-map fa-2x text-warning mb-3"></i>
                            <h6 class="text-warning">Folium Maps</h6>
                            <p class="text-muted small mb-0">Interactive mapping</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- System Status -->
    <div class="row justify-content-center mt-4">
        <div class="col-lg-8">
            <div class="system-status-card">
                <h5 class="text-center text-gradient mb-3">System Status</h5>
                <div id="systemStatus" class="d-flex justify-content-center align-items-center">
                    <div class="loading-spinner me-3"></div>
                    <span class="text-light">Checking system status...</span>
                </div>
                <div class="row mt-3 text-center">
                    <div class="col-md-4">
                        <small class="text-muted">AI Assistant</small>
                        <div id="aiStatus" class="mt-1">
                            <i class="fas fa-circle text-warning"></i>
                            <small class="text-warning">Checking</small>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <small class="text-muted">Database</small>
                        <div id="dbStatus" class="mt-1">
                            <i class="fas fa-circle text-warning"></i>
                            <small class="text-warning">Checking</small>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <small class="text-muted">Maps</small>
                        <div id="mapStatus" class="mt-1">
                            <i class="fas fa-circle text-warning"></i>
                            <small class="text-warning">Checking</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- CTA Section -->
    <div class="row justify-content-center mt-5">
        <div class="col-lg-8 text-center">
            <div class="card-dark p-5">
                <h3 class="text-gradient mb-3">Ready to Explore RERA Projects?</h3>
                <p class="text-light mb-4">Start chatting with our AI assistant or explore projects on the interactive map.</p>
                <div class="d-flex justify-content-center gap-3 flex-wrap">
                    <a href="{{ url_for('chat') }}" class="btn btn-primary-modern btn-lg">
                        <i class="fas fa-robot me-2"></i>Start AI Chat
                    </a>
                    <a href="{{ url_for('search') }}" class="btn btn-outline-modern btn-lg">
                        <i class="fas fa-search me-2"></i>Advanced Search
                    </a>
                    {% if maps_available %}
                    <a href="{{ url_for('map_view') }}" class="btn btn-outline-modern btn-lg">
                        <i class="fas fa-map me-2"></i>View Map
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Animated counter function
function animateCounter(element, target, duration = 2000) {
    let start = 0;
    const increment = target / (duration / 16);
    const timer = setInterval(() => {
        start += increment;
        if (start >= target) {
            element.textContent = target;
            clearInterval(timer);
        } else {
            element.textContent = Math.floor(start);
        }
    }, 16);
}

// Check system status
function checkSystemStatus() {
    fetch('/api/system_status')
        .then(response => response.json())
        .then(data => {
            const statusDiv = document.getElementById('systemStatus');
            const aiStatus = document.getElementById('aiStatus');
            const dbStatus = document.getElementById('dbStatus');
            const mapStatus = document.getElementById('mapStatus');
            
            if (data.system_ready) {
                let statusHTML = `
                    <i class="fas fa-check-circle text-success fa-2x me-3"></i>
                    <div>
                        <h6 class="text-success mb-1">System Ready</h6>
                        <small class="text-light">AI Assistant is online and ready to help</small>
                    </div>
                `;
                
                // Add map status if available
                if (data.maps_available) {
                    statusHTML = `
                        <i class="fas fa-check-circle text-success fa-2x me-3"></i>
                        <div>
                            <h6 class="text-success mb-1">All Systems Ready</h6>
                            <small class="text-light">AI Assistant and Interactive Maps are online</small>
                        </div>
                    `;
                }
                
                statusDiv.innerHTML = statusHTML;
                
                // Update individual status indicators
                aiStatus.innerHTML = '<i class="fas fa-circle text-success"></i><small class="text-success ms-1">Online</small>';
                dbStatus.innerHTML = '<i class="fas fa-circle text-success"></i><small class="text-success ms-1">Connected</small>';
                mapStatus.innerHTML = data.maps_available ? 
                    '<i class="fas fa-circle text-success"></i><small class="text-success ms-1">Available</small>' :
                    '<i class="fas fa-circle text-secondary"></i><small class="text-secondary ms-1">Unavailable</small>';
                    
            } else {
                statusDiv.innerHTML = `
                    <i class="fas fa-exclamation-triangle text-warning fa-2x me-3"></i>
                    <div>
                        <h6 class="text-warning mb-1">Setup Required</h6>
                        <small class="text-light">
                            <a href="/setup" class="text-warning">Run setup</a> to initialize the AI system
                        </small>
                    </div>
                `;
                
                aiStatus.innerHTML = '<i class="fas fa-circle text-danger"></i><small class="text-danger ms-1">Offline</small>';
                dbStatus.innerHTML = '<i class="fas fa-circle text-warning"></i><small class="text-warning ms-1">Setup Required</small>';
                mapStatus.innerHTML = '<i class="fas fa-circle text-secondary"></i><small class="text-secondary ms-1">Unavailable</small>';
            }
        })
        .catch(error => {
            const statusDiv = document.getElementById('systemStatus');
            statusDiv.innerHTML = `
                <i class="fas fa-times-circle text-danger fa-2x me-3"></i>
                <div>
                    <h6 class="text-danger mb-1">System Offline</h6>
                    <small class="text-light">Unable to connect to AI system</small>
                </div>
            `;
            
            document.getElementById('aiStatus').innerHTML = '<i class="fas fa-circle text-danger"></i><small class="text-danger ms-1">Offline</small>';
            document.getElementById('dbStatus').innerHTML = '<i class="fas fa-circle text-danger"></i><small class="text-danger ms-1">Offline</small>';
            document.getElementById('mapStatus').innerHTML = '<i class="fas fa-circle text-danger"></i><small class="text-danger ms-1">Offline</small>';
        });
}

// Initialize when page loads
document.addEventListener('DOMContentLoaded', function() {
    // Animate stats
    animateCounter(document.getElementById('projectsCount'), 234);
    animateCounter(document.getElementById('buildingsCount'), 150);
    animateCounter(document.getElementById('locationsCount'), 45);
    
    // Example queries
    document.querySelectorAll('.example-query').forEach(button => {
        button.addEventListener('click', function() {
            const query = this.getAttribute('data-query');
            window.location.href = "/chat?query=" + encodeURIComponent(query);
        });
    });
    
    // Add floating animation to feature cards on hover
    document.querySelectorAll('.feature-card').forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.classList.add('floating');
        });
        card.addEventListener('mouseleave', function() {
            this.classList.remove('floating');
        });
    });
    
    // Check system status
    checkSystemStatus();
    
    // Add click effects to tech stack items
    document.querySelectorAll('.tech-stack').forEach(item => {
        item.addEventListener('click', function() {
            this.style.transform = 'scale(0.95)';
            setTimeout(() => {
                this.style.transform = '';
            }, 150);
        });
    });
});

// Add intersection observer for scroll animations
document.addEventListener('DOMContentLoaded', function() {
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);

    // Observe elements for animation
    document.querySelectorAll('.feature-card, .stat-card, .tech-stack').forEach(el => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(20px)';
        el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
        observer.observe(el);
    });
});
</script>
{% endblock %}